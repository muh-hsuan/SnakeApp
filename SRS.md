# **軟體需求規格書 (Software Requirements Specification)**

**專案名稱：** 現代貪吃蛇 (Project Modern Snake)

**技術棧：** React Native

**版本：** 1.0.0 (MVP)

**日期：** 2025-11-28

## **1\. 簡介 (Introduction)**

### **1.1 目的**

本文件旨在定義基於 React Native 框架開發的現代貪吃蛇遊戲的功能與非功能需求。本專案目標是構建一款具備高流暢度（60 FPS）、現代化 UI/UX 以及基礎商業變現能力的跨平台（iOS & Android）手遊。

### **1.2 範圍**

本產品核心為單人闖關與無盡模式，後期可擴展為 .io 風格的多人對戰。開發重點在於解決 React Native 在高頻渲染下的效能瓶頸，並提供極致的觸控手感。

## **2\. 總體描述 (Overall Description)**

### **2.1 產品視角**

本應用程式為獨立運行的手機遊戲。

* **前端**：React Native (TypeScript)。  
* **渲染引擎**：React Native Skia (優先) 或 React Native Game Engine \+ SVG。  
* **本地存儲**：MMKV 或 AsyncStorage (用於存儲高分、設定)。  
* **音效**：React Native Sound / Expo AV。

### **2.2 使用者特徵**

* **休閒玩家**：通勤時間遊玩，單局時間短（1-5分鐘），重視啟動速度與單手操作。  
* **競技玩家**：追求高分排行，重視操作精準度與反應速度。

## **3\. 系統架構與技術選型 (System Architecture)**

### **3.1 渲染與遊戲循環 (Game Loop)**

鑑於 React Native 的 Bridge 通訊特性，傳統 setState 驅動的高頻渲染可能導致掉幀。

* **核心方案**：採用 **Headless JS Loop** 處理邏輯，配合 **Shared Values (Reanimated 2/3)** 或 **Skia Canvas** 直接在 UI Thread 進行渲染，繞過 Bridge。  
* **更新頻率**：邏輯層 (Tick Rate) 設定為 10-15Hz，渲染層透過**線性插值 (Linear Interpolation)** 補幀至 60Hz，確保蛇的移動視覺上平滑。

### **3.2 資料結構**

* **蛇身存儲**：使用 Deque (雙端隊列) 結構管理蛇身座標節點，優化頭尾增刪的效能 (O(1))。  
* **輸入緩衝 (Input Buffer)**：實作 FIFO 隊列，暫存玩家在兩幀之間的所有手勢輸入，防止快速轉向時的邏輯吞噬或自殺判定。

## **4\. 功能需求 (Functional Requirements)**

### **4.1 核心玩法 (Core Gameplay)**

#### **FR-01: 移動機制**

* 蛇頭應根據當前方向向量自動持續移動。  
* 支援 **網格導向 (Grid-Based)** 邏輯但呈現 **平滑移動** 視覺。  
* **穿牆模式 (Wrapping)**：蛇頭撞擊邊界時，會從對側邊界出現（環形世界）。

#### **FR-02: 操控系統 (Controls)**

* **手勢識別**：使用 react-native-gesture-handler。  
* **控制模式**：  
  1. **滑動 (Swipe)**：偵測手指滑動方向改變蛇頭轉向（需設定最小滑動距離閾值以防誤觸）。  
  2. **虛擬搖桿 (Virtual Joystick)**：(進階) 螢幕任意位置觸控喚醒搖桿，支援 360 度向量移動。  
* **輸入防呆**：禁止蛇頭直接進行 180 度反向移動（除非吃到特殊道具）。

#### **FR-03: 成長與碰撞**

* **進食**：當蛇頭座標與食物座標重疊（或進入判定半徑），蛇身長度 \+1，分數增加，播放音效。  
* **死亡判定**：  
  * 頭部撞擊邊界（非穿牆模式）。  
  * 頭部撞擊自身身體節點。  
* **遊戲結束**：彈出結算畫面，顯示本局分數、歷史最高分、復活選項。

### **4.2 遊戲物件 (Game Objects)**

#### **FR-04: 食物生成**

* 食物隨機生成在非蛇身佔據的網格上。  
* **特殊食物**：  
  * 金蘋果：分數 x2，身體 \+3。  
  * 磁鐵道具：持續 10 秒自動吸附周圍 3 格內的食物。

### **4.3 UI 與回饋 (UI & Feedback)**

#### **FR-05: HUD (抬頭顯示器)**

* 左上角：當前分數。  
* 右上角：歷史最高分 / 暫停按鈕。  
* 視覺特效 (VFX)：  
  * **螢幕震動**：使用 Haptics (Expo Haptics / react-native-haptic-feedback) 在死亡或吃到大道具時觸發震動。  
  * **粒子效果**：進食時產生簡單的粒子炸裂效果 (Skia 粒子系統)。

## **5\. 非功能需求 (Non-Functional Requirements)**

### **5.1 效能需求 (Performance)**

* **幀率**：在 iPhone 8 / Android 中階機型以上維持穩定 60 FPS。  
* **啟動時間**：冷啟動至可遊玩狀態 (Time-to-Interactive) 需 \< 3 秒。  
* **記憶體**：運行時記憶體佔用需 \< 150MB，避免被系統後台殺殺死。

### **5.2 相容性 (Compatibility)**

* **iOS**：支援 iOS 13.0+。  
* **Android**：支援 Android 8.0+。  
* **螢幕適配**：需完美適配劉海屏 (Notch) 與動態島，HUD 需避開安全區域 (Safe Area)。

## **6\. 使用者介面需求 (Interface Requirements)**

### **6.1 畫面流程**

1. **Splash Screen**：顯示 Logo，預加載資源。  
2. **主選單 (Home)**：  
   * "開始遊戲" 按鈕 (大尺寸)。  
   * "設定" (音量、控制模式)。  
   * "造型商店" (Skins)。  
3. **遊戲畫面 (In-Game)**：全螢幕沉浸式，隱藏狀態列。  
4. **暫停/結束畫面 (Overlay)**：半透明遮罩，提供 "繼續"、"重新開始"、"回主頁" 選項。

## **7\. 變現與分析 (Monetization & Analytics)**

### **7.1 廣告整合**

* **激勵視頻**：整合 AdMob，玩家死亡後可選擇觀看 30秒廣告復活一次（每局限一次）。  
* **橫幅廣告**：僅在主選單或結算畫面底部顯示，遊戲進行中**嚴禁**顯示以免干擾操作。

### **7.2 數據埋點**

* 記錄：單局時長、死亡原因（撞牆/撞身）、復活率、最高分分佈。

## **8\. 開發路線圖 (Development Roadmap)**

### **Phase 1: MVP (最小可行性產品)**

* 實作基本蛇移動、進食、死亡邏輯。  
* 使用 React Native Skia 繪製基本幾何圖形。  
* 實作滑動手勢控制。  
* 本地高分存儲。

### **Phase 2: Polish (打磨)**

* 加入粒子特效與螢幕震動。  
* 實作虛擬搖桿控制。  
* 增加兩種特殊道具（磁鐵、加倍）。  
* 實作 "復活" 機制。

### **Phase 3: Commercial (商業化)**

* 接入 AdMob 廣告 SDK。  
* 實作造型商城 (Skin Shop)。  
* 發布至 App Store 與 Google Play。